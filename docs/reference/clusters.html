<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Hierarchical Clustering and Differential Gene Expression — clusters • scrabble</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Hierarchical Clustering and Differential Gene Expression — clusters" />
<meta property="og:description" content="This function computes the clusters from the expression matrix specified by hierarchical clustering. It can also (1) filter the resulting clusters by size (if they pass min and max size cutoffs), (2) compute the sets of differentially expressed genes in each cluster, (3) filter the resulting clusters by gene significance (if they pass nsig1 and nsig2 cutoffs), (4) filter the resulting clusters by cluster similarity (if they pass the Jaccard similarity cutoff) such that for any pair of clusters with too-high similarity, the least-significant cluster is removed and (4) sort the resulting clusters by significance." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scrabble</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/scrabble.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hierarchical Clustering and Differential Gene Expression</h1>
    
    <div class="hidden name"><code>clusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes the clusters from the expression matrix specified by hierarchical clustering. It can also (1) filter the resulting clusters by size (if they pass min and max size cutoffs), (2) compute the sets of differentially expressed genes in each cluster, (3) filter the resulting clusters by gene significance (if they pass nsig1 and nsig2 cutoffs), (4) filter the resulting clusters by cluster similarity (if they pass the Jaccard similarity cutoff) such that for any pair of clusters with too-high similarity, the least-significant cluster is removed and (4) sort the resulting clusters by significance.</p>
    </div>

    <pre class="usage"><span class='fu'>clusters</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>hc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>clusters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cor.method</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>hc.method</span> <span class='kw'>=</span> <span class='st'>"average"</span>, <span class='kw'>compute.dist</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>dist.method</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>h</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>size.filter</span> <span class='kw'>=</span> <span class='no'>F</span>,
  <span class='kw'>min.size</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>max.size</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>min.rel</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>max.rel</span> <span class='kw'>=</span> <span class='fl'>0.8</span>,
  <span class='kw'>min.abs</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>DEA</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>FC</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>is.log</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
  <span class='kw'>adjust.method</span> <span class='kw'>=</span> <span class='st'>"BH"</span>, <span class='kw'>sort</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>p.sort</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>return.full</span> <span class='kw'>=</span> <span class='no'>F</span>,
  <span class='kw'>return.p</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>fast</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>significance.filter</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>nsig1</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>nsig2</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>similarity.filter</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>all.filters</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>similarity.cutoff</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>order.method</span> <span class='kw'>=</span> <span class='st'>"combined"</span>,
  <span class='kw'>ties.method</span> <span class='kw'>=</span> <span class='st'>"random"</span>, <span class='kw'>first</span> <span class='kw'>=</span> <span class='st'>"sig1"</span>, <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>sortBySignificance</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='no'>F</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>m</th>
      <td><p>matrix. Default: NULL</p></td>
    </tr>
    <tr>
      <th>hc</th>
      <td><p>hierarchical clustering (hclust) object. If provided, will be used instead of computed. Default: NULL</p></td>
    </tr>
    <tr>
      <th>cor.method</th>
      <td><p>a character string indicating which correlation coefficient is to be computed. Default: 'pearson'</p></td>
    </tr>
    <tr>
      <th>hc.method</th>
      <td><p>a character string indicating which agglomeration method to use. Default: 'average'</p></td>
    </tr>
    <tr>
      <th>compute.dist</th>
      <td><p>a boolean value indicating whether a distance measure should be computed from the correlation metric. If FALSE, distances are computed from the correlation matrix directly. Default: T</p></td>
    </tr>
    <tr>
      <th>dist.method</th>
      <td><p>a character string specifying the distance metric to be used for hierarchical clustering. Default: 'euclidean'</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>number of clusters to return. Default: NULL</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>tree height at which to retrieve clusters. Default: NULL</p></td>
    </tr>
    <tr>
      <th>size.filter</th>
      <td><p>if TRUE, will return clusters that are within the sizes specified. Default: TRUE</p></td>
    </tr>
    <tr>
      <th>min.size</th>
      <td><p>a boolean value or numeric value indicating whether there should be a minimum number of clusters or what the minimum number of clusters should be, respectively. If the former, then the minimum number of clusters will be calculated relative to the total number of members with min.rel.</p></td>
    </tr>
    <tr>
      <th>max.size</th>
      <td><p>a boolean value or numeric value indicating whether there should be a maximum number of clusters or what the maximum number of clusters should be, respectively. If the former, then the maximum number of clusters will be calculated relative to the total number of members with max.rel.</p></td>
    </tr>
    <tr>
      <th>min.rel</th>
      <td><p>minimum relative size of a cluster. Default: 0.01 (ie. 0.01 of total number of members)</p></td>
    </tr>
    <tr>
      <th>max.rel</th>
      <td><p>maximum relative size of a cluster. Default: 0.8 (ie. 0.8 of total number of members)</p></td>
    </tr>
    <tr>
      <th>min.abs</th>
      <td><p>absolute minimum size. If min.rel &lt; min.abs, min.abs will replace min.rel. Default: 5</p></td>
    </tr>
    <tr>
      <th>DEA</th>
      <td><p>a boolean value indicating whether to run Differential Gene Expression Analysis. Required if any of significance.filter or similarity.filter are set to TRUE. Default: T</p></td>
    </tr>
    <tr>
      <th>FC</th>
      <td><p>fold change cutoff. Passed to <code>genes</code>. Default: 2</p></td>
    </tr>
    <tr>
      <th>is.log</th>
      <td><p>values are in log2 (used in fold_changes). Passed to <code>genes</code>. Default: T</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>p-value cutoff. Passed to <code>genes</code>. Default: 0.01</p></td>
    </tr>
    <tr>
      <th>adjust.method</th>
      <td><p>Correction for multiple tests. If not desired, set to 'none'. Passed to <code>genes</code>. Default: 'BH'</p></td>
    </tr>
    <tr>
      <th>p.sort</th>
      <td><p>returning values are sorted by p-value (most significant first). Passed to <code>genes</code>. Default: F</p></td>
    </tr>
    <tr>
      <th>return.full</th>
      <td><p>return cluster membership and cluster DE genes. Passed to <code>genes</code>. Default: F</p></td>
    </tr>
    <tr>
      <th>return.p</th>
      <td><p>return cluster DE p-values. Passed to <code>genes</code>. Default: F</p></td>
    </tr>
    <tr>
      <th>fast</th>
      <td><p>if TRUE, computes p-values for significant fold-change values only. Passed to <code>genes</code>. Default: T</p></td>
    </tr>
    <tr>
      <th>significance.filter</th>
      <td><p>a boolean value indicating whether to remove clusters that do not pass gene significance cutoffs. Default: T</p></td>
    </tr>
    <tr>
      <th>nsig1</th>
      <td><p>cutoff for number of differentially expressed genes. Used to cut by significance (significance.filter = TRUE). If not desired, set to FALSE. Default: 30</p></td>
    </tr>
    <tr>
      <th>nsig2</th>
      <td><p>cutoff for number of most differentially expressed genes. Used to cut by significance (significance.filter = TRUE). If not desired, set to FALSE. Default: 5</p></td>
    </tr>
    <tr>
      <th>similarity.filter</th>
      <td><p>a boolean value indicating whether to remove clusters that are too similar. Default: T</p></td>
    </tr>
    <tr>
      <th>all.filters</th>
      <td><p>a boolean value indicating whether to set all filtering options to TRUE: size.filter, significance.filter, similarity.filter. Default: T</p></td>
    </tr>
    <tr>
      <th>similarity.cutoff</th>
      <td><p>numeric value between 0 and 1 defining the maximum Jaccard similarity allowed. Default: 0.8</p></td>
    </tr>
    <tr>
      <th>order.method</th>
      <td><p>character string indicating which ordering method should be used, one of 'combined', 'sequential', 'sig1' or 'sig2'. 'combined' orders by the mean of sig1 ranks and sig2 ranks. 'sequential' orders by sig1 and sig2 sequentially, ordering by the second only where there are ties in the first. 'sig1' orders by the number of elements in each vector. 'sig2' orders by the number of elements in each vector after filtering the list such that each element only appears once in the vector in which it's value is highest. Default: 'combined'</p></td>
    </tr>
    <tr>
      <th>ties.method</th>
      <td><p>character string specifying how ties are treated, see base::rank for more details.</p></td>
    </tr>
    <tr>
      <th>first</th>
      <td><p>character string indicating whether ordering should be first by sig1 and then by sig2 (default) or vice versa. One of 'sig1' or 'sig2'. Only relevant if order.method is 'sequential'. Default: 'sig1'</p></td>
    </tr>
    <tr>
      <th>decreasing</th>
      <td><p>boolean value indicating whether the list should be reordered by decreasing or increasing significance. If TRUE, the most significant vector will appear first. Default: TRUE</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>with default parameters, will compute hierarchical clustering object of the pariwise correlations of the matrix provided and retrieve all clusters at all possible heights. If the user prefers a specified number of clusters or a specified height, these can instead be provided.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>DETAILS</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='kw'>if</span>(<span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span>()){
 <span class='co'>#EXAMPLE1</span>
 }
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Julie Laffy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


